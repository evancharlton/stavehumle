import{r as l,j as e}from"./index-BBXoJzDt.js";import{M as I,a as H,b as D,c as N,d as y,e as K}from"./Modal-D1BwHG7-.js";import"./firebase-import-BUDYfVK1.js";import{f as G,u as k,d as w,F as z,n as J,b as U,h as X}from"./useFoundWords-qo4Idc7-.js";import"./useLang-DtiibKzr.js";const Y="_container_1te7c_1",Q="_guess_1te7c_5",V="_letterButton_1te7c_17",Z="_centerLetter_1te7c_43",ee="_letterButtons_1te7c_56",se="_controls_1te7c_60",_={container:Y,guess:Q,letterButton:V,centerLetter:Z,letterButtons:ee,controls:se},R=s=>new Set(s.split("")).size===7,P=s=>{if(s.length<4)return 0;if(s.length===4)return 1;const t=R(s)?7:0;return s.length+t},A=s=>({score:l.useMemo(()=>s.map(n=>P(n)).reduce((n,o)=>n+o,0),[s])}),E=()=>{const{found:s,revealedWords:t}=G(),{all:n,centerLetter:o}=k(),{words:u}=w();return{onGuess:l.useCallback(c=>{if(!c)return;const r=c.toLocaleLowerCase().split("").filter(a=>n.includes(a)).join("");if(r.length!==c.length){dispatchEvent(new CustomEvent("bad-guess",{detail:"invalid-letters"}));return}if(r.length<4){dispatchEvent(new CustomEvent("bad-guess",{detail:"too-short"}));return}if(!r.includes(o)){dispatchEvent(new CustomEvent("bad-guess",{detail:"missing-center"}));return}if(s[r]){dispatchEvent(new CustomEvent("bad-guess",{detail:"already-found"}));return}if(t.includes(r)){dispatchEvent(new CustomEvent("bad-guess",{detail:"revealed"}));return}if(!u.includes(r)){dispatchEvent(new CustomEvent("bad-guess",{detail:"unknown-word"}));return}dispatchEvent(new z(r,new Date,"local"))},[n,o,s,t,u]),found:Object.keys(s),revealedWords:t}},T=s=>s.map(t=>({sort:Math.random(),value:t})).sort((t,n)=>t.sort-n.sort).map(t=>t.value),te=()=>{const{outerLetters:s}=k(),[t,n]=l.useState([]),o=l.useCallback(()=>{n(T(s))},[s]);return l.useEffect(()=>{n(T(s))},[s,n]),{shuffled:t,reshuffle:o}},p=({letter:s,className:t,onClick:n,...o})=>e.jsx("button",{"data-letter":s,className:[_.letterButton,t].filter(Boolean).join(" "),...o,onMouseUp:n,children:s}),ne=s=>e.jsx(p,{...s,className:_.centerLetter}),re=()=>{const{onGuess:s}=E(),{all:t,centerLetter:n,outerLetters:o}=k(),[u,i]=l.useState(""),{shuffled:c,reshuffle:r}=te(),a=l.useRef("");a.current=u,l.useEffect(()=>{a.current="",i("")},[o,n]);const f=l.useCallback(()=>{s(a.current),i("")},[s,a]),j=l.useCallback(h=>{const g=h.currentTarget.getAttribute("data-letter");i(C=>`${C}${g}`)},[i]),x=l.useCallback(()=>{i(h=>h.substr(0,h.length-1))},[i]),b=l.useCallback(h=>{const{key:d}=h;if(d==="Backspace"){i(g=>g.substring(0,g.length-1));return}if(d===" "){r(),h.preventDefault();return}d==="Enter"&&f(),t.includes(d.toLocaleLowerCase())&&i(g=>`${g}${d}`)},[t,f,r]);return l.useEffect(()=>(document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}),[b]),e.jsxs("div",{className:_.container,children:[e.jsx("div",{className:_.guess,children:u||e.jsx(e.Fragment,{children:" "})}),e.jsxs("div",{className:_.letterButtons,children:[e.jsxs("div",{className:_.topRow,children:[e.jsx(p,{disabled:!1,onClick:j,letter:c[0]}),e.jsx(p,{disabled:!1,onClick:j,letter:c[1]})]}),e.jsxs("div",{className:_.middleRow,children:[e.jsx(p,{disabled:!1,onClick:j,letter:c[2]}),e.jsx(ne,{disabled:!1,onClick:j,letter:n}),e.jsx(p,{disabled:!1,onClick:j,letter:c[3]})]}),e.jsxs("div",{className:_.bottomRow,children:[e.jsx(p,{disabled:!1,onClick:j,letter:c[4]}),e.jsx(p,{disabled:!1,onClick:j,letter:c[5]})]})]}),e.jsxs("div",{className:_.controls,children:[e.jsx("button",{onClick:x,"aria-label":"baksiden",children:e.jsx(I,{})}),e.jsx("button",{onClick:r,"aria-label":"tilfeldig rekkefølge",children:e.jsx(H,{})}),e.jsx("button",{onClick:f,"aria-label":"sende inn",children:e.jsx(D,{})})]})]})},oe=({reason:s})=>{let t="";switch(s){case"already-found":t="ordet er allerede funnet";break;case"invalid-letters":t="bruker ugyldige bokstaver";break;case"missing-center":t="mangler obligatorisk bokstaven";break;case"too-short":t="for kort";break;case"unknown-word":t="ukjent ord";break;case"revealed":t="tidligere avslørt";break;default:return J(s,null)}return e.jsx("span",{children:t})},le="_container_1brqu_1",ae="_pangram_1brqu_24",ce="_points_1brqu_29",$={container:le,pangram:ae,points:ce},ie=s=>!!(s&&s.points),de=s=>!!(s&&s.isPangram),ue=()=>{const[s,t]=l.useState(),n=l.useRef(),o=l.useCallback(r=>{if(t(r),n.current&&clearTimeout(n.current),!r){n.current=null;return}n.current=setTimeout(()=>{t(void 0),n.current=null},2500)},[n,t]),u=l.useCallback(r=>{const a=r.detail;o(a)},[o]),i=l.useCallback(({word:r,source:a})=>{a==="local"&&(R(r)?o({points:P(r),isPangram:!0}):o({points:P(r)}))},[o]);l.useEffect(()=>(window.addEventListener("bad-guess",u),()=>{window.removeEventListener("bad-guess",u)}),[u]),U(i);const c=l.useMemo(()=>s?de(s)?e.jsxs("span",{className:$.pangram,children:["Pangram!",e.jsx("br",{}),"+",s.points," poeng"]}):ie(s)?e.jsxs("span",{className:$.points,children:["+",s.points," poeng"]}):e.jsx(oe,{reason:s}):null,[s]);return e.jsx("div",{className:$.container,children:c})},he="_gameContainer_4jfbn_1",me="_buttonsContainer_4jfbn_8",O={gameContainer:he,buttonsContainer:me},ge="_container_hf73d_1",fe="_grid_hf73d_5",je="_border_hf73d_14",xe="_letter_hf73d_18",be="_filler_hf73d_22",_e="_header_hf73d_26",ve="_mode_hf73d_39",pe="_active_hf73d_46",m={container:ge,grid:fe,border:je,letter:xe,filler:be,header:_e,mode:ve,active:pe},M=e.jsx("span",{className:m.filler,children:"–"}),ke=({words:s,range:[t,n]})=>{const{all:o}=k(),u=[e.jsx("th",{children:" "},"blank")],i=[];for(let r=t;r<=n;r+=1){u.push(e.jsx("th",{children:r},r));const a=s.filter(f=>f.length===r).length;i.push(e.jsx("td",{children:a||M},`total @ ${r}`))}u.push(e.jsx("th",{children:"Σ"},"column-sum"));const c=[];for(let r=0;r<o.length;r+=1){const a=o[r],f=s.filter(x=>x[0]===a),j=[e.jsx("td",{className:[m.border,m.letter].join(" "),children:a},a)];for(let x=t;x<=n;x+=1){const b=f.filter(h=>h.length===x).length;j.push(e.jsx("td",{children:b||M},`${a} @ ${x}`))}j.push(e.jsx("td",{className:m.border,children:f.length||M},`${a} @ total`)),c.push(e.jsx("tr",{children:j},`row-${a}`))}return c.push(e.jsxs("tr",{className:m.border,children:[e.jsx("td",{children:"Σ"}),i,e.jsx("td",{children:s.length})]},"row-totals")),e.jsxs("table",{className:m.grid,children:[e.jsx("thead",{children:e.jsx("tr",{className:m.border,children:u})}),e.jsx("tbody",{children:c})]})},Ce="_button_54v5t_1",Ne={button:Ce},we=()=>{const[s,t]=l.useState(!1),n=l.useMemo(()=>s?e.jsxs(N,{title:"Oversikt",onClose:()=>t(!1),children:[e.jsx("p",{children:"Oversikten er et verktøy for å hjelpe deg å finne alle ordene i puslespillet. Radene viser antall ord som starter med en viss bokstav, og kolonnene viser antall ord av hver lengde."}),e.jsx("p",{children:"Oversikten viser også antall ord totalt. Lykke til med å finne alt!"})]}):null,[s,t]);return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:Ne.button,onClick:()=>t(!0),"aria-label":"Oversikten hjelp",children:e.jsx(y,{})}),n]})},L=(...s)=>s.filter(Boolean).join(" "),Ee=()=>{const{found:s}=E(),{words:t}=w(),[n,o]=l.useState("remaining"),u=l.useMemo(()=>{if(n==="all")return t;if(n==="found")return s;const c=s.reduce((r,a)=>({...r,[a]:!0}),{});return t.filter(r=>!c[r])},[n,t,s]),i=t.reduce(([c,r],a)=>[Math.min(c,a.length),Math.max(r,a.length)],[1e3,3]);return e.jsxs("div",{className:m.container,children:[e.jsxs("div",{className:m.header,children:[e.jsx("button",{onClick:()=>o("found"),className:L(m.mode,m.found,n==="found"&&m.active),children:"Funnet"}),e.jsx("button",{onClick:()=>o("remaining"),className:L(m.mode,m.remaining,n==="remaining"&&m.active),children:"Gjenstår"}),e.jsx("button",{onClick:()=>o("all"),className:L(m.mode,m.all,n==="all"&&m.active),children:"Alt"}),e.jsx(we,{})]}),e.jsx(ke,{range:i,words:u})]})},$e="_container_1v8o8_1",Me="_bars_1v8o8_10",Le="_progressBarContainer_1v8o8_18",Be="_progress_1v8o8_18",We="_genius_1v8o8_36",Se="_currentPoints_1v8o8_44",Pe="_totalPoints_1v8o8_48",ye="_help_1v8o8_53",v={container:$e,bars:Me,progressBarContainer:Le,progress:Be,genius:We,currentPoints:Se,totalPoints:Pe,help:ye},Ge=()=>{const{found:s}=E(),{words:t}=w(),{score:n}=A(s),{score:o}=A(t),[u,i]=l.useState(!1),c=l.useMemo(()=>u?e.jsxs(N,{title:"Poeng",onClose:()=>i(!1),children:[e.jsx("p",{children:"Poeng beregnes ut fra antall ord som har blitt funnet. Hvert ord gir ulike poengsummer."}),e.jsxs("ul",{children:[e.jsxs("li",{children:["ord på fire bokstaver er verdt ",e.jsx("strong",{children:"ett poeng"})]}),e.jsxs("li",{children:["hver bokstave etter fire er verdt ",e.jsx("strong",{children:"ett ekstra poeng"})]}),e.jsxs("li",{children:["ord som bruker alle bokstavene minst en gang (et pangram) gir"," ",e.jsx("strong",{children:"syv ekstra poeng"})]})]}),e.jsx("h3",{children:"Eksempel"}),e.jsxs("p",{children:["H I K L O S ",e.jsx("strong",{children:"T"})]}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"hist"})," er 4 poeng"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"hittil"})," er 6 poeng"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"holistisk"})," er (9 + 7) = 16 poeng"]})]})]}):null,[u]),r=100*n/o,a=r>=70;return e.jsxs("div",{className:v.container,children:[e.jsxs("div",{className:v.bars,children:[e.jsx("span",{className:v.currentPoints,children:n}),e.jsx("div",{className:[v.progressBarContainer,a&&v.genius].filter(Boolean).join(" "),title:`${n} av ${o} poeng`,id:"points-progress",children:e.jsx("div",{className:v.progress,style:{width:`${r.toFixed(2)}%`}})}),e.jsx("span",{className:v.totalPoints,children:o})]}),e.jsx("button",{onClick:()=>i(!0),className:v.help,"aria-label":"poeng hjelp",children:e.jsx(y,{})}),c]})},Re="_container_p790x_1",Fe="_wordList_p790x_12",Ae="_content_p790x_26",Te="_buttons_p790x_32",B={container:Re,wordList:Fe,content:Ae,buttons:Te},Oe="_button_1hkt1_1",qe={button:Oe},Ie=()=>{const[s,t]=l.useState(!1),n=l.useMemo(()=>s?e.jsxs(N,{title:"«Hva er disse ordene?»",onClose:()=>t(!1),children:[e.jsxs("p",{children:["Ordene som brukes her kommer fra den"," ",e.jsx("a",{href:"https://www.nb.no/sprakbanken/ressurskatalog/oai-nb-no-sbr-5/",target:"_blank",rel:"noopener noreferrer",children:"Norske ordbanken"}),". Alle ord finnes, men noen ord blir sjelden (eller aldri) sett i det virkelige liv."]}),e.jsxs("p",{children:[e.jsx("a",{href:"mailto:evancharlton+humle@gmail.com",target:"_blank",rel:"noopener noreferrer",children:"Skriv en e-post"})," ","hvis du finner et galt ord 😀"]})]}):!1,[s]);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>t(!0),className:qe.button,"aria-label":"funnet ord hjelp",children:e.jsx(y,{})}),n]})},He="_reveal_1qnsu_1",De="_revealContainer_1qnsu_27",Ke="_revealGrid_1qnsu_54",W={reveal:He,revealContainer:De,revealGrid:Ke},ze=()=>{const{revealAnswers:s}=X(),[t,n]=l.useState(!1),{found:o,revealedWords:u}=G(),{words:i}=w(),{all:c}=k(),r=l.useMemo(()=>[...c],[c]),[a,f]=l.useMemo(()=>i.reduce(([x,b],h)=>[Math.min(x,h.length),Math.max(b,h.length)],[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER]),[i]),j=l.useMemo(()=>{if(!t)return null;const x=new Set(u),b=i.filter(d=>!o[d]&&!x.has(d)),h=[];h.push(e.jsx("span",{}));for(let d=a;d<=f;d+=1)h.push(e.jsx("button",{disabled:!b.some(g=>g.length===d),onClick:()=>{s({which:"length",length:d}),n(!1)},children:d},`length-${d}`));for(const d of r){h.push(e.jsx("button",{disabled:!b.some(g=>g[0]===d),onClick:()=>{s({which:"letter",letter:d}),n(!1)},children:d},`letter-${d}`));for(let g=a;g<=f;g+=1){const C=b.filter(F=>F[0]===d&&F.length===g).length;h.push(e.jsx("button",{disabled:C===0,onClick:()=>{s({which:"letter-length",length:g,letter:d}),n(!1)},children:C},`letter-length-${d}-${g}`))}}return e.jsxs(N,{title:"Er du ferdig?",onClose:()=>n(!1),children:[e.jsx("h2",{children:"Avdekke alle ordene?"}),e.jsxs("p",{children:["Når du er ferdig, kan du vise alle ordene. Du har"," ",b.length," ord som gjenstår!"]}),e.jsxs("div",{className:W.revealContainer,children:[e.jsx("div",{className:W.revealGrid,style:{gridTemplateColumns:`repeat(${f+2-a}, 1fr)`},children:h}),e.jsx("button",{onClick:()=>{s({which:"all"}),n(!1)},children:"Jeg er helt ferdig!"})]}),e.jsxs("p",{children:["Hvis du vil forsette å søke, klikk på ",e.jsx("strong",{children:"«Lukk»"})," ","nedenfor."]})]})},[t,u,i,f,a,s,o,r]);return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:W.reveal,onClick:()=>n(!0),"aria-label":"Avdekke ordene",children:e.jsx(K,{})}),j]})},Je="_word_105ix_1",Ue="_revealed_105ix_12",Xe="_pangram_105ix_16",S={word:Je,revealed:Ue,pangram:Xe},Ye=s=>s.currentTarget.blur(),Qe=({children:s})=>{const{found:t}=G(),n=!t[s],o=R(s);return e.jsx("a",{className:[S.word,n&&S.revealed,o&&S.pangram].filter(Boolean).join(" "),href:`https://naob.no/søk?q=${s}`,target:"_blank",rel:"noopener noreferrer",onClick:Ye,children:s},s)},Ve=()=>{const{found:s,revealedWords:t}=E(),n=l.useMemo(()=>[...s,...t].sort().map(o=>e.jsx(Qe,{children:o},o)),[s,t]);return e.jsxs("div",{className:B.container,children:[e.jsxs("div",{className:B.buttons,children:[e.jsx(Ie,{}),e.jsx(ze,{})]}),e.jsx("div",{className:B.wordList,children:n})]})},Ze="_column_l18s3_1",es="_header_l18s3_14",q={column:Ze,header:es},ss=()=>e.jsxs("div",{className:q.column,children:[e.jsx("div",{className:q.header,children:e.jsx(Ge,{})}),e.jsx(Ee,{}),e.jsx(Ve,{})]}),as=()=>e.jsxs("div",{className:O.gameContainer,children:[e.jsxs("div",{className:O.buttonsContainer,children:[e.jsx(ue,{}),e.jsx(re,{})]}),e.jsx(ss,{})]});export{as as default};
